{% extends 'master' %}

{% block header %}
  <h1>Programmēšanas uzdevumi</h1>
  <pre><code class="python">if not Happy(): beHappy()</code></pre>
{% endblock %}

{% block content %}
      {{ form.open({route: 'problem/test/edit_save', params: {id: problem.id}, class:"form-horizontal", files: true}) }}
      {{ form.hidden('id', problem.id ) }}

      {{ csrfField }}

        <div class="form-group">
          {{ form.label('memory', 'Atmiņas limits (Mb)', {class: 'col-md-4 control-label'}) }}
          <div class="col-md-2">
            {{ form.text('memory', old('memory') or problem.memory, {class: 'form-control', placeholder:"512", required: true}) }}
          </div>
        </div>

        <div class="form-group">
          {{ form.label('timelimit', 'Laika limits (s)', {class: 'col-md-4 control-label'}) }}
          <div class="col-md-2">
            {{ form.text('timelimit', old('timelimit') or problem.timelimit, {class: 'form-control', placeholder:"0.5", required: true}) }}
          </div>
        </div>

        <div class="form-group">
          {{ form.label('test_file', 'Uzdevuma testu failu zip arhīvs', {class: 'col-md-4 control-label'}) }}
          <div class="col-md-6">
            {{ form.file('test_file') }}
          </div>
        </div>
        <p class="bg-info">
          Testu failu zip arhīvs ir līdz 100mb liels fails ar zip paplašinājumu, nesatur direktorijas, tikai testa failus formātā "\w+.(i|o)(\d+)(\w?)",
          kur pirmā grupa norāda vai fails ir ievadfails, vai izvadfails, otrā grupa norāda testa grupas numuru, trešā grupa norāda testa identifikatoru grupā.
        </p>

        <div class="form-group">
          {{ form.label('checker_file', 'Čekera fails (cpp fails)', {class: 'col-md-4 control-label'}) }}
          <div class="col-md-6">
            {{ form.file('test_file') }}
          </div>
        </div>
        <p class="bg-info">
          Testu failu zip arhīvs ir līdz 100mb liels fails ar zip paplašinājumu.
        </p>

        <div class="form-group">
          <div class="col-md-4 col-md-offset-8 text-right">
            {{ form.button('Saglabāt', 'Saglabāt', {class: "btn btn-primary"}) }}
          </div>
        </div>
        {{ form.close() }}
      </div>
    </div>

    {% if tests.length == 0 %}
      <p class="bg-info">
        Diemžēl nav pievienots neviens tests.
      </p>
    {% else %}
      <p class="text-right editmenu">
        <a href="{{ 'problem/test/download' | route({id: problem.id}) }}">
          <span class="glyphicon glyphicon-download" aria-hidden="true"></span> Lejupielādēt testu zip failu
        </a>
      </p>
      <table class="table table-condensed">
        <thead>
          <tr>
            <th>#</td>
            <th>Ievadfails</td>
            <th>Izvadfails</td>
            <th>Numurs</td>
            <th>Numurs grupā</td>
          </tr>
        </thead>
        <tbody>
          {% set i=0 %}
          {% for test in tests %}
            <tr>
              <td>
                {% set i=i+1 %}
                {{ i }}
              </td>
              <td>
                {{ test.input_filename }}
              </td>
              <td>
                {{ test.output_filename }}
              </td>
              <td>
                {{ test.number }}
              </td>
              <td>
                {{ test.gid }}
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    {% endif %}

  {% endblock %}

  {% block sidebar %}
    {% include 'problem/admin_sidebar' %}
  {% endblock %}
